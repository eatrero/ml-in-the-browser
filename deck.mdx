export { future as theme } from 'mdx-deck/themes';
import { Head, Appear, Notes } from 'mdx-deck';
import { CodeSurfer } from 'mdx-deck-code-surfer';
import nightOwl from 'prism-react-renderer/themes/nightOwl';

<Head>
  <title>ML in the Browser</title>
</Head>

## ML in the Browser
### with Tensorflow.js

<br />
<br />

#### Ed Atrero

##### Weedmaps Tech Meetup

---
<h1>Demo</h1>

---
<h2>Machine Learning</h2>
<Appear>
  <h3>Computer Vision</h3>
  <h4>Image Classification</h4>
  <p>Convolutional Neural Network (CNN)</p>
</Appear>

---
<Appear>
  <h1>1. Model</h1>
  <h1>2. Train</h1>
  <h1>3. Predict</h1>
</Appear>


---
<h1>Tensorflow</h1>

<Appear>
  <p>Library released by Google Brain team in 2015.</p>
  <p>Processing multidimensional array (like neural networks)</p>
  <p>CPUs, GPUs, TPUs</p>
  <p>architecture handles parallel</p>
</Appear>

---
<h3>Convolutional Neural Networks</h3>
![cnn](./static/cnn.png )

<Notes>
convolution 

kernel... looking for spatial coherence
analagous to plaaying with slides

O(n^2 * sizeof(layers) * sizeof(data_set)) = weeks w/ $10k rig of high end cards
</Notes>
---

<h3>convolution</h3>
![cnn](./static/2d-convolution.gif)

---

<h3>weights</h3>
![cnn](./static/weights.jpg)
---
Transfer Learning
![cnn](./static/cnn.png )

---
<h1>Tensorflow</h1>

<Appear>
  <p>Library released by Google Brain team in 2015.</p>
  <p>Processing multidimensional array (like neural networks)</p>
  <p>CPUs, GPUs, TPUs</p>
</Appear>
---

<CodeSurfer
  code={require('!raw-loader!./code/train.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 67] },
    { range: [9, 34] },
    { lines: [12] },
  ]}
/>

---

<h1>tf.sequential()</h1>


<Appear>
  <p>Creates a tf.Sequential model.</p> 
  <p>A sequential model is any model where the outputs of one layer are the inputs to the next layer</p>
  <p>The model topology is a simple 'stack' of layers, with no branching or skipping.</p>
</Appear>

---

<CodeSurfer
  code={require('!raw-loader!./code/train.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { lines: [12] },
    { lines: [13, 33], notes: "layers" },
    { range: [14,17] },
    { range: [18,24] },
    { range: [25,32] },
    { range: [9,34] },
  ]}
/>

---
![gradient descent](./static/mobilenet.png )

---

train

---

<CodeSurfer
  code={require('!raw-loader!./code/train.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [57, 66] },
  ]}
/>





---

<h3> Stochastic Gradient Descent </h3>
![gradient descent](./static/gradient-descent-1.png )

---
![gradient descent](./static/gradient-descent-2.png )

---

![gradient descent](./static/opt2.gif )

---
predict

---

references

[mobilenet_v2](https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py)