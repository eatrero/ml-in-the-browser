import WmLogo from './src/wm-logo'
export theme from './src/theme';
import { Head, Appear, Notes } from 'mdx-deck';
import { CodeSurfer } from 'mdx-deck-code-surfer';
import nightOwl from 'prism-react-renderer/themes/nightOwl';

<Head>
  <title>ML in the Browser</title>
</Head>

## ML in the Browser
### with Tensorflow.js
<br />
  <WmLogo/>
<br />
<br />

#### Ed Atrero

##### Weedmaps Tech Meetup

---
<h2>Machine Learning</h2>
<Appear>
  <h3>Computer Vision</h3>
  <h4>Image Classification</h4>
</Appear>

<Notes>
  <p>other CV: object detection, defect detection in manufacturing, autonomous vehicle navigation, military</p>
</Notes>

---
<h1>Demo</h1>

---
<h2>Machine Learning</h2>
  <h3>Computer Vision</h3>
  <h4>Image Classification</h4>
<Appear>
  <p>Convolutional Neural Network (CNN)</p>
</Appear>

---
<h3>Convolutional Neural Networks</h3>
![cnn](./static/cnn.png )

<Notes>
  <p>templates (convolutions)</p>
  <p>classifers (arranged)</p>
  <p>analog world</p>
  <p>hardware / algos didn't exist</p>
</Notes>

---

<h3>What is a Convolution?</h3>
![cnn](./static/2d-convolution.gif)

<Notes>
  <p>why? how well does this match w/ my template?</p>
  <p>what? compute dot product (element by element multiply than sum)</p>
  <p>same concept used in cellular networks, gps, deep space comm, except your templates are electromagnetic waves</p>
</Notes>
---

<h3>weights</h3>
![cnn](./static/weights.jpg)
---
Machine Learning Steps:
<Appear>
  <h1>1. Model</h1>
  <h1>2. Train</h1>
  <h1>3. Predict</h1>
</Appear>

<Notes>
<p> model usually a NN</p>
<p> train on labeled data</p>
<p>predict</p>
<p> rinse wash repeat cycle</p>
</Notes>


---
<h3>Transfer Learning</h3>
![cnn](./static/cnn.png )

<Notes>
  <p>models take enormous times to optimize (days/weeks on data sets of millions of images)</p>
  <p>transfer learning</p>
  <p> take an existing model</p>
  <p>freeze feature extraction. keep the weights</p>
  <p>new classifier. train quickly (minutes/hours).</p>
</Notes>

---
<h1>Tensorflow</h1>

<Appear>
  <p>Library released by Google Brain team in 2015.</p>
  <p>Processing multidimensional arrays (tensors)</p>
  <p>CPUs, GPUs, TPUs</p>
</Appear>

---
<h1>Tensorflow.js</h1>

<Appear>
  <p>The JS version of tensorflow</p>
  <p>Uses GPU via WebGL shaders</p>
  <p>ML portion of the demo in less than 100 lines</p>
</Appear>
---

<h1>Model</h1>

---

<CodeSurfer
  code={require('!raw-loader!./code/model.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 56] },
    { range: [1, 10] },
    { range: [18, 44] },
    { range: [47, 52] },
  ]}
/>

<Notes>
  <p>A sequential model is any model where the outputs of one layer are the inputs to the next layer</p>
  <p>The model topology is a simple 'stack' of layers, with no branching or skipping.</p>
</Notes>


---

<h1>Training</h1>

---
<CodeSurfer
  code={require('!raw-loader!./code/train.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1,23] },
    { lines: [13] },
    { lines: [14] },
  ]}
/>

---

<h3> Stochastic Gradient Descent </h3>
![gradient descent](./static/gradient-descent-1.png )

<Notes>
  <p>error function</p>
  <p>solving for slope is zero</p>
  <p>closed form solution is hard for higher dimensions</p>
  <p>as name implies you take random steps, compute error</p>
  <p>can be computed because you know what the data should be, and the result of your model</p>
  <p>i.e. i gave my model a picture of a cat, but the model classified it as a dog</p>
  <p>minimize error function</p>
</Notes>

---

![gradient descent](./static/opt2.gif )


---

<h1>Predict</h1>

---

<CodeSurfer
  code={require('!raw-loader!./code/predict.js')}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  steps={[
    { range: [1, 31] },
    { range: [4, 19] },
    { lines: [8,9,10] },
    { lines: [12,13,14] },
    { lines: [18] },
    { range: [21, 25] },
  ]}
/>

<Notes>
  <p>tf.tidy cleans up memory when you're done.</p>
</Notes>

---

<Notes>
  <p>demo</p>
</Notes>

---

<h1>Thanks!</h1>

---

<h1>References</h1>
<p>[https://playground.tensorflow.org/](https://playground.tensorflow.org/)</p>
<p>slides => ![slides](./static/qr.png)</p>
<p>[https://github.com/eatrero/transfer-learning](https://github.com/eatrero/transfer-learning)</p>
